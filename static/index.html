<!DOCTYPE html>
<html lang="zh-hant-TW">

<head>
    <meta charset="utf-8">
    <title>Hello world</title>
    <link rel="stylesheet" href="dist/main.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
    <div id="mapwrap">
        <div id="cal">
            <div>
            	<span>Address:</span><p id="address"></p>
            	<span>Private Key:</span><p id="private_key"></p>
                <h2><button id="new_wallet" class="btn btn-primary">New Wallet</button></h2>
                <h2><button id="remove_wallet" class="btn btn-danger" style="display: none;">Remove Wallet</button></h2>
            </div>
        </div>
        <div id="toolbar">
            <div class="hamburger">
                <span>Menu</span>
            </div>
            <div id="menu">
                <h2>Youbike Stops</h2>
                <ul><a href="#">DEMO 1</a></ul>
                <ul><a href="#">DEMO 2</a></ul>
                <ul><a href="#">DEMO 3</a></ul>
                <h2>Token Cal</h2>
            </div>
        </div>
        <a id="locate" href="#" class="float">
			<i class="fa fa-map-marker-alt my-float"></i>
		</a>
        <div id="map"></div>
    </div>
    <script src="dist/bundle.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>
    function addressToLatLng(addr) {
        var geocoder = new google.maps.Geocoder();
        geocoder.geocode({
            "address": addr
        }, function(results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
                console.log(results[0].geometry.location.lat() + "," + results[0].geometry.location.lng() + "\n");
            } else {
                console.log(addr + "查無經緯度" + "\n");
            }
        });
    }

    function geolocate() {
    	infoWindow = new google.maps.InfoWindow;
	    if (navigator.geolocation) {
	      navigator.geolocation.getCurrentPosition(function(position) {
	        var pos = {
	          lat: position.coords.latitude,
	          lng: position.coords.longitude
	        };

	        infoWindow.setPosition(pos);
	        infoWindow.setContent('Location found.');
	        console.log(pos);
	      }, function() {
	        handleLocationError(true, infoWindow, map.getCenter());
	      });
	    } else {
	      // Browser doesn't support Geolocation
	      handleLocationError(false, infoWindow, map.getCenter());
	    }
    }

    $('#toolbar .hamburger').on('click', function() {
        $(this).parent().toggleClass('open');
    });

    $(function() {
    	if (localStorage.youbike_wallet) {
	        $('#address').text(JSON.parse(localStorage.youbike_wallet)[0]);
	        $('#private_key').text(JSON.parse(localStorage.youbike_wallet)[1]);
    		$('#new_wallet').hide();
        	$('#remove_wallet').show();
    	}
	    
	});

    $('#new_wallet').on('click', function() {
        generate();
        $('#address').text(newWallet[0]);
        $('#private_key').text(newWallet[1]);
        localStorage.youbike_wallet = JSON.stringify(newWallet);
        $('#new_wallet').hide();
        $('#remove_wallet').show();
    });

    $('#remove_wallet').on('click', function() {
        generate();
        $('#address').text("");
        $('#private_key').text("");
        localStorage.youbike_wallet = "";
        $('#new_wallet').show();
        $('#remove_wallet').hide();
    });

    $('#locate').on('click', function() {
        geolocate();
    });
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
</body>

</html>